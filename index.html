<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Op-A</title>

    <link rel="stylesheet" type="text/css" href="style.css" />
    <!-- <link rel="stylesheet" type="text/css" href="knob.css" /> -->
    <link rel="stylesheet" type="text/css" href="knob_V2.css" />

    <script src="libraries/jquery/3.6.0/jquery.min.js"></script>
    
  </head>

  <body>

    <div id="myModal" class="modal">
      <div class="modal-content">
        <h2>Click Anywhere to Start</h2>
      </div>
    </div>

    <div class="title">
      <img id="OP-A" src="img/OP-A.jpg" alt="Op-A" />

      <!-- <p>
          Op-A is a web application that allows you to play with sound and
          visuals. It is a project developed for Advanced Coding Tools And 
          Metodologies by a group of students from Politecnico di Milano. 
          The application is based on the transformation of MIDI signals, 
          which are used to generate sound and control the movement of 
          objects on the screen. The application is divided into three main 
          sections: the MIDI Transformer, the Effects section and the Arpeggiator. 
          The MIDI Transformer allows you to transform the MIDI signals received 
          from an external device, changing the key and mode of the notes. 
          The Effects section allows you tomodify the sound of the notes 
          generated by the MIDI Transformer usingdifferent effects such as 
          reverb, distortion, chorus and flanger. TheArpeggiator allows you 
          to create complex rhythmic patterns by combining different notes 
          and controlling the speed and direction of the arpeggio. 
          The application is designed to be used with an external MIDI controller, 
          but it can also be controlled using the computer keyboard. 
          Op-A is a fun and creative tool that allows you to explore
          the world of sound and music in a new and exciting way.
        </p> -->

      <div class="credits">
        <p>ACTAM Project, MAE, Politecnico di Milano, A.Y. 2023-2024.</p>
        <p>
          Github repository:
          <a
            href="https://github.com"
            style="display: inline; color: var(--text-color)"
            >https://github.com</a
          >
        </p>
        <p>
          credits: Alessandro Manattini, Mattia Montanari, Giorgio Magalini.
        </p>
      </div>
    </div>

    <div class="opAGrid">
      <div class="containerMidiQuantizer">
        <div
          style="position: relative; width: 100%; height: 10%; display: flex"
        >
          <p style="position: absolute; font-size: 30px">Midi Transformer</p>
          <button class="controlButtons" id="onOffButton">off</button>
        </div>
        <div class="background" id="midiQuantBackground">
          <div class="grid" id="midiQuantGrid">
            <div class="screen" id="modeScreen">
              <canvas id="bkgndModeCanvas"></canvas>
              <div class="carouselContainer" id="carouselModeContainer">
                <div class="carousel" id="modeCarousel">
                  <div class="slide mode lydian" id="4">VI</div>
                  <div class="slide mode ionian" id="1">I</div>
                  <div class="slide mode mixolydian" id="5">V</div>
                  <div class="slide mode dorian" id="2">II</div>
                  <div class="slide mode aeolian" id="6">VI</div>
                  <div class="slide mode phrygian" id="3">III</div>
                  <div class="slide mode locrian" id="7">VII</div>
                </div>
              </div>
              <canvas id="frgndModeCanvas"></canvas>
              <img
                class="gloss"
                id="glossMode"
                alt="Display gloss image"
                src="svg/gloss.svg"
              />
            </div>
            <div class="screen" id="keyScreen">
              <canvas id="bkgndKeyCanvas"></canvas>
              <div class="carouselContainer" id="carouselKeyContainer">
                <div class="carousel" id="keySignatureCarousel">
                  <div class="slide keySignature C" id="0">C</div>
                  <div class="slide keySignature Cs" id="1">C#</div>
                  <div class="slide keySignature D" id="2">D</div>
                  <div class="slide keySignature Ds" id="3">D#</div>
                  <div class="slide keySignature E" id="4">E</div>
                  <div class="slide keySignature F" id="5">F</div>
                  <div class="slide keySignature Fs" id="6">F#</div>
                  <div class="slide keySignature G" id="7">G</div>
                  <div class="slide keySignature Gs" id="8">G#</div>
                  <div class="slide keySignature A" id="9">A</div>
                  <div class="slide keySignature As" id="10">A#</div>
                  <div class="slide keySignature B" id="11">B</div>
                </div>
              </div>
              <canvas id="frgndKeyCanvas"></canvas>
              <img
                class="gloss"
                id="glossKey"
                width="200"
                alt="Display gloss image"
                src="svg/gloss.svg"
              />
            </div>
            <div class="innerBlock" id="nextModeContainer">
              <div class="controlButtons nextPrev_button" id="nextMode">
                mode +
              </div>
            </div>
            <div class="innerBlock" id="prevModeContainer">
              <div class="controlButtons nextPrev_button" id="prevMode">
                mode -
              </div>
            </div>
            <div class="innerBlock" id="nextKeyContainer">
              <div class="controlButtons nextPrev_button" id="nextKey">
                key +
              </div>
            </div>
            <div class="innerBlock" id="prevKeyContainer">
              <div class="controlButtons nextPrev_button" id="prevKey">
                key -
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="containerEffects">
        <div style="position: relative; width: 100%; display: flex">
          <p style="position: relative; font-size: 30px">Effects</p>
        </div>
        <div class="sliderContainer" id="reverbContainer">
          <button class="controlButtons effectButton" id="reverb">
            reverb
          </button>
          <div class="sliderInnerContainer">
            <input
              type="range"
              min="0"
              max="100"
              value="50"
              class="slider"
              id="reverb"
            />
          </div>
        </div>
        <div class="sliderContainer" id="delayContainer">
          <button class="controlButtons effectButton" id="delay">delay</button>
          <div class="sliderInnerContainer">
            <input
              type="range"
              min="0"
              max="100"
              value="50"
              class="slider"
              id="delay"
            />
          </div>
        </div>
        <div class="sliderContainer" id="chorusContainer">
          <button class="controlButtons effectButton" id="chorus">
            chorus
          </button>
          <div class="sliderInnerContainer">
            <input
              type="range"
              min="0"
              max="100"
              value="50"
              class="slider"
              id="chorus"
            />
          </div>
        </div>
        <div class="sliderContainer" id="phaserContainer">
          <button class="controlButtons effectButton" id="phaser">
            phaser
          </button>
          <div class="sliderInnerContainer">
            <input
              type="range"
              min="0"
              max="100"
              value="50"
              class="slider"
              id="phaser"
            />
          </div>
        </div>
      </div>

      <div class="containerArp">
        <div class="background">
          <div class="grid">
            <div class="screen" id="matterScreen">
              <canvas id="canvas_poly"></canvas>
              <img
                class="gloss"
                id="glossMatter"
                alt="Display gloss image"
                src="svg/gloss.svg"
              />
            </div>

            <div class="innerBlock" id="controlsBlock">
              <div id="knobBlock">
                <!-- <div class="knobContainer">
                  <div class="knob" id="knobAperture">
                    <div class="knob-area">
                      <div class="pointer-container">
                        <div class="knob-pointer"></div>
                      </div>
                    </div>
                    <svg viewBox="0 0 100 100" width="100" height="100">
                      <circle class="backgroundCircle" cx="50" cy="50" r="45" />
                      <circle class="progressCircle" cx="50" cy="50" r="45" />
                    </svg>
                  </div>
                  <p class="knobTxt" id="apertureText">APERTURE</p>
                </div>

                <div class="knobContainer">
                  <div class="knob" id="knobGravity">
                    <div class="knob-area">
                      <div class="pointer-container">
                        <div class="knob-pointer"></div>
                      </div>
                    </div>
                    <svg
                      viewBox="0 0 100 100"
                      width="100"
                      height="100"
                      id="gravityKnobSvg"
                    >
                      <defs>
                        <filter
                          id="glow"
                          x="-50%"
                          y="-50%"
                          width="200%"
                          height="200%"
                        >
                          <feGaussianBlur stdDeviation="2.5" result="glow" />
                          <feMerge>
                            <feMergeNode in="glow" />
                            <feMergeNode in="SourceGraphic" />
                          </feMerge>
                        </filter>
                      </defs>
                      <circle class="backgroundCircle" cx="50" cy="50" r="45" />
                      <circle class="progressCircle" cx="50" cy="50" r="45" />
                    </svg>
                  </div>
                  <p class="knobTxt" id="gravityText">GRAVITY</p>
                </div>

                <div class="knobContainer">
                  <div class="knob" id="knobSpeed">
                    <div class="knob-area">
                      <div class="pointer-container">
                        <div class="knob-pointer"></div>
                      </div>
                    </div>
                    <svg viewBox="0 0 100 100" width="100" height="100">
                      <circle class="backgroundCircle" cx="50" cy="50" r="45" />
                      <circle class="progressCircle" cx="50" cy="50" r="45" />
                    </svg>
                  </div>
                  <p class="knobTxt" id="reverbText">SPEED</p>
                </div> -->

                <div class="containerKnob">
                  <div class="shadowContainerKnob"></div>
                  <svg viewBox="0 0 100 100" class="dial-svg">
                    <path
                      class="progBarGroove"
                      d="M50,95 A 45 45 0 1 1 50.0001 95"
                    ></path>
                    <path
                      class="progBarPath"
                      d="M50,95 A 45 45 0 1 1 50.0001 95"
                    ></path>
                  </svg>
                  <div class="knob" id="gravity">
                    <div class="indicator"></div>
                  </div>
                  <p class="knobTxt" id="gravityText">gravity</p>
                </div>
                <div class="containerKnob">
                  <div class="shadowContainerKnob"></div>
                  <svg viewBox="0 0 100 100" class="dial-svg">
                    <path
                      class="progBarGroove"
                      d="M50,95 A 45 45 0 1 1 50.0001 95"
                    ></path>
                    <path
                      class="progBarPath"
                      d="M50,95 A 45 45 0 1 1 50.0001 95"
                    ></path>
                  </svg>
                  <div class="knob hasNegativeRotation" id="rotation_speed">
                    <div class="indicator"></div>
                  </div>
                  <p class="knobTxt" id="reverbText">speed</p>
                </div>
                <div class="containerKnob">
                  <div class="shadowContainerKnob"></div>
                  <svg viewBox="0 0 100 100" class="dial-svg">
                    <path
                      class="progBarGroove"
                      d="M50,95 A 45 45 0 1 1 50.0001 95"
                    ></path>
                    <path
                      class="progBarPath"
                      d="M50,95 A 45 45 0 1 1 50.0001 95"
                    ></path>
                  </svg>
                  <div class="knob hasNegativeRotation" id="aperture">
                    <div class="indicator"></div>
                  </div>
                  <p class="knobTxt" id="apertureText">aperture</p>
                </div>
              </div>
            </div>
            <div class="innerBlock" id="lowerblock">
              <div class="keyboard-block">
                <div class="synthControls">
                  <div class="synthTranspositionControls" style="width: 26%;">
                    <p id="oct">transpose</p>
                    <button class="controlButtons transpose" id="octaveDown">
                      -
                    </button>
                    <button class="controlButtons transpose" id="octaveUp">
                      +
                    </button>
                  </div>

                  <div class="synthOscillatorControls" style="width: 56%;">
                    <p id="typeOsc">osc type</p>
                    <button class="controlButtons oscType number" id="0">
                      1
                    </button>
                    <button class="controlButtons oscType number" id="1">
                      2
                    </button>
                    <button class="controlButtons oscType number" id="2">
                      3
                    </button>
                    <button class="controlButtons oscType number" id="3">
                      4
                    </button>
                    <button class="controlButtons oscType random" id="random">
                      rnd
                    </button>
                    <button class="controlButtons oscType random" id="random2">
                      rnd2
                    </button>
                  </div>
                </div>

                <div class="notes-block">
                  <div class="notes-black">
                    <button id="Cs" class="black-key"></button>
                    <button id="Ds" class="black-key"></button>
                    <button id="Fs" class="black-key"></button>
                    <button id="Gs" class="black-key"></button>
                    <button id="As" class="black-key"></button>
                    <button id="Cs1" class="black-key"></button>
                    <button id="Ds1" class="black-key"></button>
                    <button id="Fs1" class="black-key"></button>
                  </div>

                  <div class="notes-white">
                    <button id="C" class="white-key"></button>
                    <button id="D" class="white-key"></button>
                    <button id="E" class="white-key"></button>
                    <button id="F" class="white-key"></button>
                    <button id="G" class="white-key"></button>
                    <button id="A" class="white-key"></button>
                    <button id="B" class="white-key"></button>
                    <button id="C1" class="white-key"></button>
                    <button id="D1" class="white-key"></button>
                    <button id="E1" class="white-key"></button>
                    <button id="F1" class="white-key"></button>
                    <button id="G1" class="white-key"></button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="midiSelector">
        <div style="display: flex; justify-content: space-between; width: 100%">
          <label for="midiSelectInput" style="font-size: 22px"
            >MIDI Input Device:
            <select
              id="midiSelectInput"
              style="
                font-size: 22px;
                border: none;
                border-radius: 10px;
                background: content-box;
              "
            ></select>
          </label>
          <label for="midiSelectOutput" style="font-size: 22px"
            >MIDI Output Device:
            <select
              id="midiSelectOutput"
              style="
                font-size: 22px;
                border: none;
                border-radius: 10px;
                background: content-box;
              "
            ></select>
          </label>
        </div>
      </div>
    </div>
    <button id="toggleMidiMenu">close midi I/O selector</button>
  </body>

  <script>

    function resize() {
      if (window.innerWidth / window.innerHeight > 1440 / 821) {
        var ratio = window.innerHeight / 821;
      } else {
        var ratio =  window.innerWidth / 1440;
      }

      const originalZoom = 67;
      const newZoom = originalZoom * ratio;

      document.body.style.width = "100%"
      
      document.body.style.zoom = newZoom + "%";
      
    }

    resize();

    window.addEventListener('resize', resize);
  </script>

  <script src="libraries/p5.min.js"></script>

  <script src="libraries/matter.js"></script>

  <!-- <script src="libraries/tone.js"></script> -->

  <!-- <script src="https://cdn.jsdelivr.net/npm/tone"></script> -->

  <!-- <script src="https://www.gstatic.com/firebasejs/7.2.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.2.0/firebase-firestore.js"></script> -->

  <!-- including javascript code for knobs implementation -->

  <!-- <script language="javascript" type="text/javascript" src="knob.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/Draggable.min.js"></script> -->

  <script
    language="javascript"
    type="text/javascript"
    src="knob_V2.js"
  ></script>

  <script
    language="javascript"
    type="text/javascript"
    src="soundGenerator.js"
  ></script>

  <script
    language="javascript"
    type="text/javascript"
    src="matterArp.js"
  ></script>
  <script language="javascript" type="text/javascript" src="ball.js"></script>
  <script
    language="javascript"
    type="text/javascript"
    src="boundary.js"
  ></script>
  <script
    language="javascript"
    type="text/javascript"
    src="polygon.js"
  ></script>
  <script
    language="javascript"
    type="text/javascript"
    src="midiUtils.js"
  ></script>
  <script
    language="javascript"
    type="text/javascript"
    src="carousel.js"
  ></script>
  <script
    language="javascript"
    type="text/javascript"
    src="controller.js"
  ></script>
  <script language="javascript" type="text/javascript" src="menu.js"></script>
</html>
